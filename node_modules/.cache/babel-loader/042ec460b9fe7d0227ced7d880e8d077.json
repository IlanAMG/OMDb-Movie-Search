{"ast":null,"code":"var _jsxFileName = \"/Users/Ilan/PROGRAMMATION/FORMATION/UDEMY_OMDdAPI_Films/starter/omdb-movie-starter/src/App.js\";\nimport React, { useState, useEffect } from \"react\";\nimport { Links, FavoriteBtn, Header, Modal, Result, Results, SearchForm } from './components';\nimport { read } from './firebase/firebase';\nconst constants = {\n  BASE_URL: 'http://www.omdbapi.com/?',\n  API_KEY: 'c044a8f8'\n};\n\nconst App = () => {\n  const [state, setState] = useState({\n    isSearching: false,\n    active: \"search\",\n    movies: [],\n    favorites: [],\n    query: \"\" //resultat de la requête\n\n  });\n\n  const onTextChange = input => {\n    setState({ ...state,\n      isSearching: input.length > 0,\n      query: input\n    }); // on verifie si l'user tape ou non\n  };\n\n  const handleClick = link => {\n    setState({ ...state,\n      active: link\n    });\n  };\n\n  const toggleFavorite = movie => {\n    if (state.active === 'search') {\n      const updated = state.movies.map(m => {\n        if (m.imdb === movie.imdb) {\n          m.isFavorite = !m.isFavorite;\n          return m;\n        }\n\n        return m;\n      });\n      const favorites = updated.filter(m => m.isFavorite);\n      setState({ ...state,\n        movies: updated,\n        favorites: favorites\n      });\n    }\n  };\n\n  const fetchAPI = () => {\n    if (!state.query) {\n      return;\n    }\n\n    const url = `${constants.BASE_URL}s=${state.query}&apikey=${constants.API_KEY}`;\n    fetch(url).then(res => {\n      if (!res.ok) {\n        throw Error(res.statusText);\n      }\n\n      return res.json();\n    }).then(data => {\n      if (data.Response !== 'False') setState({ ...state,\n        movies: create(data.Search)\n      });\n    });\n  };\n\n  const fetchDB = () => {\n    read().then(snapshot => {\n      const favorites = snapshot.docs.map(doc => doc.data());\n      setState({ ...state,\n        favorites\n      });\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  const create = data => {\n    return data.map(item => {\n      return {\n        title: item.Title,\n        imdb: item.imdbID,\n        year: item.Year,\n        type: item.Type,\n        poster: item.Poster,\n        isFavorite: false\n      };\n    });\n  };\n\n  useEffect(() => {\n    fetchAPI();\n  }, [state.query]);\n  useEffect(() => {\n    fetchDB();\n  }, []);\n  return React.createElement(\"div\", {\n    className: \"App\",\n    id: \"search-container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81\n    },\n    __self: this\n  }, React.createElement(Header, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82\n    },\n    __self: this\n  }), React.createElement(Links, Object.assign({}, state, {\n    handleClick: handleClick,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83\n    },\n    __self: this\n  })), React.createElement(\"main\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84\n    },\n    __self: this\n  }, React.createElement(SearchForm, {\n    onTextChange: onTextChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85\n    },\n    __self: this\n  }), React.createElement(Results, Object.assign({}, state, {\n    toggleFavorite: toggleFavorite,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86\n    },\n    __self: this\n  }))));\n};\n\nexport default App;","map":{"version":3,"sources":["/Users/Ilan/PROGRAMMATION/FORMATION/UDEMY_OMDdAPI_Films/starter/omdb-movie-starter/src/App.js"],"names":["React","useState","useEffect","Links","FavoriteBtn","Header","Modal","Result","Results","SearchForm","read","constants","BASE_URL","API_KEY","App","state","setState","isSearching","active","movies","favorites","query","onTextChange","input","length","handleClick","link","toggleFavorite","movie","updated","map","m","imdb","isFavorite","filter","fetchAPI","url","fetch","then","res","ok","Error","statusText","json","data","Response","create","Search","fetchDB","snapshot","docs","doc","catch","err","console","log","item","title","Title","imdbID","year","Year","type","Type","poster","Poster"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport {Links, FavoriteBtn, Header, Modal, Result, Results, SearchForm} from './components'\nimport { read } from './firebase/firebase'\n\nconst constants = {\n  BASE_URL: 'http://www.omdbapi.com/?',\n  API_KEY: 'c044a8f8'\n}\n\nconst App = () => {\n  const [state, setState] = useState({\n    isSearching: false,\n    active: \"search\",\n    movies: [],\n    favorites: [],\n    query: \"\" //resultat de la requête\n  });\n\n  const onTextChange = input => {\n    setState({ ...state, isSearching: input.length > 0, query: input }) // on verifie si l'user tape ou non\n  }\n\n  const handleClick = link => {\n    setState({...state, active: link})\n  }\n\n  const toggleFavorite = movie => {\n    if (state.active === 'search') {\n    const updated = state.movies.map(m => {\n      if (m.imdb === movie.imdb) {\n        m.isFavorite = !m.isFavorite\n        return m\n      }\n      return m\n      })\n      const favorites = updated.filter(m => m.isFavorite)\n      setState({...state, movies: updated, favorites: favorites})\n    } \n  }\n\n  const fetchAPI = () => {\n    if(!state.query) { return }\n    const url = `${constants.BASE_URL}s=${state.query}&apikey=${constants.API_KEY}`\n    fetch(url)\n      .then(res => {\n        if(!res.ok) { throw Error(res.statusText)}\n        return res.json()\n      })\n      .then(data => {\n        if(data.Response !== 'False')\n        setState({...state, movies: create(data.Search)})\n      })\n  }\n\n  const fetchDB = () => {\n    read()\n      .then(snapshot => {\n        const favorites = snapshot.docs.map(doc => doc.data())\n        setState({...state, favorites})\n      })\n      .catch(err => {\n        console.log(err)\n      })\n  }\n\n  const create = data => {\n    return data.map(item => {\n      return {title: item.Title, imdb: item.imdbID, year: item.Year, type: item.Type, poster: item.Poster, isFavorite: false}\n    })\n  }\n\n  useEffect(() => {\n    fetchAPI()\n  }, [state.query])\n\n  useEffect(() => {\n    fetchDB()\n  }, [])\n\n  return (\n    <div className=\"App\" id=\"search-container\">\n      <Header />\n      <Links {...state} handleClick={handleClick}/>\n      <main>\n        <SearchForm onTextChange={onTextChange}/>\n        <Results {...state} toggleFavorite={toggleFavorite} />\n      </main>\n    </div>\n  );\n};\nexport default App;\n"]},"metadata":{},"sourceType":"module"}